"use strict";(self.webpackChunkulbi=self.webpackChunkulbi||[]).push([[832],{4102:(e,t,a)=>{a.r(t),a.d(t,{default:()=>q});var r=a(6540),n=a(423);const s={list:"Qvnphi79"};var o=a(2389),i=a(8623),c=a(5307),l=a(8363),u=a(467),d=a(4756),v=a.n(d),f=a(2492),p=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.isLoading)||!1},g=function(e){var t;return null===(t=e.articlesPage)||void 0===t?void 0:t.error},h=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.view)||l.Uv.SMALL},m=function(e){var t;return(null===(t=e.articlesPage)||void 0===t?void 0:t.page)||1},y=function(e){var t,a;return null!==(t=null===(a=e.articlesPage)||void 0===a?void 0:a.order)&&void 0!==t?t:"asc"},x=function(e){var t,a;return null!==(t=null===(a=e.articlesPage)||void 0===a?void 0:a.sort)&&void 0!==t?t:f.vs.CREATED},j=function(e){var t,a;return null!==(t=null===(a=e.articlesPage)||void 0===a?void 0:a.search)&&void 0!==t?t:""},P=function(e){var t,a;return null!==(t=null===(a=e.articlesPage)||void 0===a?void 0:a.type)&&void 0!==t?t:f.PF.ALL},b=a(296);var S=(0,c.zD)("articlesPage/fetchArticlesList",function(){var e=(0,u.A)(v().mark((function e(t,a){var r,n,s,o,i,c,u,d,f,p;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.extra,n=a.rejectWithValue,v=(s=a.getState)(),void 0,o=(null===(g=v.articlesPage)||void 0===g?void 0:g.limit)||9,i=x(s()),c=j(s()),u=y(s()),d=m(s()),f=P(s()),e.prev=7,t={sort:i,order:u,search:c,type:f},window.history.pushState(null,"",function(e){var t=new URLSearchParams(window.location.search);return Object.entries(e).forEach((function(e){var a=(0,b.A)(e,2),r=a[0],n=a[1];void 0!==n&&t.set(r,n)})),"?".concat(t.toString())}(t)),e.next=11,r.api.get("/articles",{params:{_expand:"user",_limit:o,_page:d,_sort:i,_order:u,q:c,type:f===l.PF.ALL?void 0:f}});case 11:if((p=e.sent).data){e.next=14;break}throw new Error;case 14:return e.abrupt("return",p.data);case 17:return e.prev=17,e.t0=e.catch(7),e.abrupt("return",n("error"));case 20:case"end":return e.stop()}var t,v,g}),e,null,[[7,17]])})));return function(t,a){return e.apply(this,arguments)}}()),w=a(3276),C=(0,c.pU)({selectId:function(e){return e.id}}),N=C.getSelectors((function(e){return e.articlesPage||C.getInitialState()})),A=(0,c.Z0)({name:"articlesPageSlice",initialState:C.getInitialState({isLoading:!1,error:void 0,view:l.Uv.SMALL,ids:[],entities:{},page:1,hasMore:!0,_inited:!1,order:"asc",sort:f.vs.CREATED,search:"",limit:9,type:f.PF.ALL}),reducers:{setView:function(e,t){e.view=t.payload,localStorage.setItem(w.k,t.payload)},setPage:function(e,t){e.page=t.payload},setOrder:function(e,t){e.order=t.payload},setSort:function(e,t){e.sort=t.payload},setSearch:function(e,t){e.search=t.payload},setType:function(e,t){e.type=t.payload},initState:function(e){var t=localStorage.getItem(w.k);e.view=t,e.limit=t===l.Uv.BIG?4:9,e._inited=!0}},extraReducers:function(e){e.addCase(S.pending,(function(e,t){e.error=void 0,e.isLoading=!0,t.meta.arg.replace&&C.removeAll(e)})).addCase(S.fulfilled,(function(e,t){e.isLoading=!1,e.hasMore=t.payload.length>=e.limit,t.meta.arg.replace?C.setAll(e,t.payload):C.addMany(e,t.payload)})).addCase(S.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}),O=A.reducer,k=A.actions,L=a(2828),E=a(572),T=(0,c.zD)("articlesPage/fetchNextArticlesPage",function(){var e=(0,u.A)(v().mark((function e(t,a){var r,n,s,o,i;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.getState,n=a.dispatch,t=r(),void 0,s=null===(c=t.articlesPage)||void 0===c?void 0:c.hasMore,o=m(r()),i=p(r()),s&&!i&&(n(k.setPage(o+1)),n(S({})));case 5:case"end":return e.stop()}var t,c}),e)})));return function(t,a){return e.apply(this,arguments)}}());const D={sortWrapper:"iE1gM70c",search:"SSeRUIsN",tabs:"gdHxKfPC"};var R=a(1468),I=a(3334),M=a(493);var F=a(4848),U=function(e){var t=e.className,a=e.label,s=e.options,o=e.value,i=e.onChange,c=e.readonly,l=(0,r.useMemo)((function(){return null==s?void 0:s.map((function(e){return(0,F.jsx)("option",{className:"JkXz98qY",value:e.value,children:e.content},e.content)}))}),[s]);return(0,F.jsx)(F.Fragment,{children:(0,F.jsxs)("div",{className:(0,n.x)("cidfdn6H",{},[t]),children:[a&&(0,F.jsx)("span",{className:"G1uuf7Bp",children:"".concat(a,">")}),(0,F.jsx)("select",{disabled:c,value:o,onChange:function(e){null==i||i(e.target.value)},className:"VOKOuKGo",children:l})]})})},V=(0,r.memo)((function(e){var t=e.className,a=e.sort,s=e.order,i=e.onChangeOrder,c=e.onChangeSort,l=(0,o.Bd)().t,u=(0,r.useMemo)((function(){return[{value:"asc",content:l("возрастание")},{value:"desc",content:l("убывание")}]}),[l]),d=(0,r.useMemo)((function(){return[{value:f.vs.CREATED,content:l("дате создания")},{value:f.vs.TITLE,content:l("названия ")},{value:f.vs.VIEWS,content:l("просмотрам")}]}),[l]);return(0,F.jsxs)("div",{className:(0,n.x)("ZLTqFYwT",{},[t]),children:[(0,F.jsx)(U,{options:d,label:l("Сортировать по"),value:a,onChange:c}),(0,F.jsx)(U,{options:u,label:l("по"),value:s,onChange:i,className:"UluTXxzR"})]})})),_=(0,r.memo)((function(e){var t,a,s=e.className,i=(0,o.Bd)().t,c=(0,L.j)(),u=(0,R.d4)(h),d=(0,R.d4)(j),v=(0,r.useCallback)((function(){c(S({replace:!0}))}),[c]),f=(t=v,500,a=(0,r.useRef)(),(0,r.useCallback)((function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];a.current&&clearTimeout(a.current),a.current=setTimeout((function(){t.apply(void 0,r)}),500)}),[t,500])),p=(0,r.useCallback)((function(e){c(k.setView(e))}),[c]),g=(0,r.useCallback)((function(e){c(k.setOrder(e)),c(k.setPage(1)),v()}),[c,v]),m=(0,r.useCallback)((function(e){c(k.setSort(e)),c(k.setPage(1)),v()}),[c,v]),b=(0,r.useCallback)((function(e){c(k.setSearch(e)),c(k.setPage(1)),v()}),[c,v]),w=(0,r.useCallback)((function(e){console.log(1),c(k.setType(e)),c(k.setPage(1)),f()}),[c,f]),C=(0,R.d4)(y),N=(0,R.d4)(x),A=(0,R.d4)(P);return(0,F.jsxs)("div",{className:(0,n.x)(D.ArticlesPageFilters,{},[s]),children:[(0,F.jsxs)("div",{className:D.sortWrapper,children:[(0,F.jsx)(V,{order:C,sort:N,onChangeOrder:g,onChangeSort:m}),(0,F.jsx)(l.u9,{view:u,onViewClick:p})]}),(0,F.jsx)(I.Z,{className:D.search,children:(0,F.jsx)(M.p,{placeholder:i("Поиск по"),value:d,onChange:b})}),(0,F.jsx)(l.rR,{onChangeType:w,value:A,className:D.tabs})]})}));const B={};var z=a(4976),Z=a(4768),H=(0,c.zD)("articlesPage/initArticlesPage",function(){var e=(0,u.A)(v().mark((function e(t,a){var r,n,s,o,i,c;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=a.getState,n=a.dispatch,void 0,(null===(l=r().articlesPage)||void 0===l?void 0:l._inited)||(s=t.get("order"),o=t.get("sort"),i=t.get("search"),c=t.get("type"),s&&n(k.setOrder(s)),o&&n(k.setSort(o)),i&&n(k.setSearch(i)),c&&n(k.setType(c)),n(k.initState()),n(S({})));case 3:case"end":return e.stop()}var l}),e)})));return function(t,a){return e.apply(this,arguments)}}()),K=(0,r.memo)((function(e){var t=e.className,a=((0,o.Bd)().t,(0,L.j)()),r=(0,R.d4)(N.selectAll),s=(0,R.d4)(p),i=((0,R.d4)(g),(0,R.d4)(h)),c=(0,z.ok)(),u=(0,b.A)(c,1)[0];return(0,Z.b)((function(){a(H(u))})),(0,F.jsx)("div",{className:(0,n.x)(B.articlInfiniteList,{},[t]),children:(0,F.jsx)(l.R2,{className:B.list,isLoading:s,view:i,articles:r})})})),W={articlesPage:O},X=function(e){var t=e.className,a=((0,o.Bd)().t,(0,L.j)()),c=(0,r.useCallback)((function(){a(T())}),[a]);return(0,F.jsx)(i.H,{reducers:W,children:(0,F.jsxs)(E.Y,{onScrollEnd:c,className:(0,n.x)(s.ArticlePage,{},[t]),children:[(0,F.jsx)(_,{}),(0,F.jsx)(K,{className:s.list})]})})};const q=(0,r.memo)(X)},493:(e,t,a)=>{a.d(t,{p:()=>v});var r=a(4467),n=a(296),s=a(3986),o=a(6540);var i=a(423),c=a(4848),l=["className","value","onChange","type","placeholder","autofocus","readonly"];function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function d(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){(0,r.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var v=(0,o.memo)((function(e){var t=e.className,a=e.value,u=e.onChange,v=e.type,f=void 0===v?"text":v,p=e.placeholder,g=e.autofocus,h=e.readonly,m=(0,s.A)(e,l),y=(0,o.useRef)(null),x=(0,o.useState)(!1),j=(0,n.A)(x,2),P=j[0],b=j[1],S=(0,o.useState)(0),w=(0,n.A)(S,2),C=w[0],N=w[1];(0,o.useEffect)((function(){var e;g&&(b(!0),null===(e=y.current)||void 0===e||e.focus())}),[g]);var A=(0,r.A)({},"FNvHopTh",h),O=P&&!h;return(0,c.jsxs)("div",{className:(0,i.x)("ZVD48a0h",A,[t]),children:[p&&(0,c.jsx)("div",{className:"KZfiEngX",children:"".concat(p,">")}),(0,c.jsxs)("div",{className:"frsbeEPT",children:[(0,c.jsx)("input",d(d({readOnly:h,ref:y,type:f,value:a,onChange:function(e){null==u||u(e.target.value),N(e.target.value.length)}},m),{},{className:"rXny0DUV",onBlur:function(){b(!1)},onFocus:function(){b(!0)},onSelect:function(e){var t;N((null==e||null===(t=e.target)||void 0===t?void 0:t.selectionStart)||0)}})),O&&(0,c.jsx)("span",{style:{left:"".concat(9*C,"px")},className:"UVFlQ4wJ"})]})]})}))}}]);